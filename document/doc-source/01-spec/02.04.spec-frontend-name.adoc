ifndef::imagesdir[:imagesdir: ../images]
:data-uri:
:table-caption!:

=== 常用命名

本章命名规范主要针对代码内部的一些书写技巧和特殊命名，开发人员可以参考这些命名打造自己的平台、应用等做各种自定义操作。

Zero UI 中包含了特殊的 `DataX` 数据模型（ `TypeScript` ），全局变量主要面向一个 React 组件默认 `props` 属性，当您看到对应内容之后可以直接阅读每个变量以及含义。

[TIP]
====
组件变量主要针对 `ExAdmin` 这种模板，包括 `DxAdmin` 这种开发专用模板，而其他组件的属性变量都会直接从模板继承。

- 全局类型：所有的组件都会拥有的变量，且通常为**只读**。
- 局部只读：一般是组件内 `props` 相关变量，这种变量来自父组件，但由于 `props` 本身不可变更，这种类型变量也不可以更改，但**不同组件这种变量内容不同**。
- 局部可变：一般是组件内 `state` 相关变量，这种变量来自组件本身的 `componentDidMount` 函数（初始化生命周期）。
====

注意描述信息中的加粗前缀：

- **L** 表示 List 列表专用属性或状态
- **F** 表示 Form 表单专用属性或状态
- **Q** 表示 Qr 查询引擎相关的属性或状态（但凡牵涉查询引擎无关列表和表单）
- **A5** 则表示升级到 `AntD 5.x` 之后出现的属性和状态

若您未启用 `zero-atom` 的动态建模功能，那么全局部分只有全局属性，无全局状态，本章先不讲解全局状态，这部分内容放到新版动态建模中去讲解。

==== 全局属性

一个组件常用的前端变量信息如下：

[options="header",cols="3,3,6"]
|====
|名称|类型|含义
|`$app` | `DataObject` a|进入界面时从远程读取的应用相关配置，对应后端的 `X_APP` 中的配置信息，主要分两种形态：

- 登录前：登录前的配置数据中，`X_APP` 不会包含 **模块化** 部分，且移除了部分敏感信息，只保留了原始的应用程序配置。
- 登录后：登陆后的配置数据中，会包含 `B_BLOCK / B_BAG` 相关的模块配置信息（ `zero-battery` 启用才生效）。
|`$user` | `DataObject` a|用户的基本信息，这个变量只有在用户登录之后生效，Zero Extension 应用中配备了 `zero-rbac` 模块，此处的用户信息实际就是存储的 `S_USER` 以及关联的 **员工信息**。
|`$router` | `DataRouter` |封装了 `react-router` 之后的路由对象，在原始路由基础上追加了 Zero UI 独有的信息，和传统浏览器运行时相结合，实现升级的路由功能。
|`$menus` | `DataArray` |当前应用的菜单信息，对应后端的 `X_MENU` 表中的数据，**注意这个变量中存储了所有菜单数据**；还有一点需注意，虽然此处菜单数据虽然是全局类型，但由于 **权限系统** 的存在，不同角色/账号读取出来的菜单信息会有所不同。
|「**L** / **F**」`$myDefault`| `Object` | 存储了当前列表的默认视图信息，对应后端 `zero-rbac` 模块中的角色视图功能。
|「**F**」`$myView` | `Object` | 存储了个人视图相关信息，对应后端 `zero-rbac` 模块中的自定义视图的基本配置信息。
|「**A5**」`skin`| `Object` | 当前应用的皮肤信息，新版中**皮肤管理器** 配置数据，对应 `AntD` 中的 `token` 样式信息。
|「**A5**」`$setting`| `Object` | 存储了当前应用使用的模板设置信息，对应 `Ant-Pro` 专用配置，这个设置和皮肤管理器协同可实现个人设置、风格更改、模板定制等和个人相关的功能。
|`fnApp` | `Function` | 加载应用配置专用函数，若配置丢失可尝试在组件内部调用提取 `$app` 对象的数据。
|`fnOut` | `Function` | Redux的读写函数，用于将数据写入到 Redux 状态树中，实现跨界点数据交互。
|`react` | `Component` | 顶层组件引用，一般是路由直接入口组件的专用引用（ `UI.js` ）。
|`reference` | `Component` | 父组件引用，您可以在编程过程中使用 `Ux.onReference(X, N)` 来提取整个分支中的任意组件引用信息。
|`store` | `Object` | Redux 专用存储对象，此处是在某个版本升级过程中无法提取 `store` 的一个补丁。
|====

由于 `$setting` 中存储的信息是从 **AntD 3.x** 升级到 **AntD 5.x** 的过程中才出现的设计，所以个人设置中的视图配置 `$myDefault / $myView` 并没有包含其中，正常设计中个人设置的信息应该使用 `$setting` 来存储，但由于历史原因，视图这一层就不放在个人设置中了，直接使用 `$myX` 的方式代替，但是在后续的开发过程中，`$myX` 系列的配置可以作为 `$setting` 的子配置来托管，目前已经找到对应解决方案处理这种冲突。

==== 组件属性

[options="header",cols="3,3,6"]
|====
|名称|类型|含义
|`$options` | `Object` a| 辅助配置，此配置有两个作用：

- 开发人员可以随意存储数据到此变量中，对组件和模型的本体（配置和数据）都不产生影响，且内部可以随意使用。
- 此变量可以做从父组件到子组件（配置和数据）的穿透变量，如 `List -> Form`，当您想要从最外层传入数据到 `Form` 时，可存储数据在 `$options` 中跳过 `List` 组件。
|`config` | `Object` |当前组件的核心配置信息。
|`data` | `Object` |当前组件所需的核心数据信息。
|`$identifier` | `String` | 当前组件绑定的统一模型标识符，此模型标识符一般是静态绑定专用。
|`$inited` | `Object` | 初始化数据，如表单数据、组件选择之、菜单选中值等。
|`$synonym` | `Object` | 同义词语法，用于别名修改标签文字专用。
|`$record` | `<Any>` | 关联记录、父记录、三方记录、辅助记录专用对象（非当前组件绑定的主模型记录）。
|「**L**」`$form` | `Object` |当前组件关联的专用表单配置，`key = FormComponent` 的结构，其中 `FormComponent` 是一个 React 的组件。
|「**L**」`$executor` | `Object` |当前组件关联的专用函数配置，`key = Function` 的结构，其中 `Function` 是一个JavaScript函数，一般是二阶，也可以是高阶函数（取决于组件内部消费）。
|「**L**」`$view` | `String` |当前列表所处的基础状态，包含 `add, edit, view` 三种，`ExListComplex` 组件深度使用。
|「**F**」`$subject` | `Object` | （配置界面）多了一种表单的字段渲染器，`aiSubject` 用于渲染特殊类型的区域块信息，和 `aiTitle` 近似。
|「**F**」`$addKey`| `String` | 表单专用数据主键，添加表单（ `$mode = ADD` ）中使用。
|「**F**」`$mode`| `String` | 表单模式，目前支持模式：`ADD、EDIT、SEARCH、DESIGN` 四种。
|「**F**」`$op`| `Object` | 操作专用结构，`key = Function` 的结构，其中 `Function` 是一个表单相关的执行函数，一般也是二阶，和 `$executor` 的区别在于此函数配置仅用于表单按钮部分。
|「**F**」`$edition` | `Object \| Boolean` | 表单专用ACL控制属性，用于控制表单的三态：只读、可编辑、ACL隐藏。
|「**Q**」`$qr`| `Object` | 查询表单中初始值，现阶段有两个位置使用：QxCriteria 组件、高级搜索 FormFilter。
|「**Q**」`$query`| `Object` | 标准查询引擎结构，带 `criteria, projection, sorter, pager` 要素。
|====

==== State：状态数据

[options="header",cols="3,3,6"]
|====
|名称|类型|含义
|`$ready`| `Boolean` | 判断组件中配置是否加载完成，通常是 `componentDidMount` 执行完成后设置成 **true**。
|`$loading` | `Boolean` | 判断组件中数据是否加载完成，一般组件会按照：先配置后数据 的方式执行初始化。
|`$submitting` | `Boolean` | 判断组件是否处于提交状态，防止重复提交专用属性。
|`$spinning` | `Boolean` | 和 `$loading` 协同的多路加载中间态，这个属性会启动复杂刷新：刷新流程简单时只使用 `$loading` 即可，若过于复杂则依赖 `$spinning` 和 `$loading` 配合。
|`$visible` | `Boolean` | 当前组件是隐藏还是显示，此状态主要用于**模态窗、抽屉窗、浮游窗**在受控模式下的主动控制。
|`$hoc` | `HocI18n / HocI18r` | 和资源文件 `cab/xxx` 绑定的核心配置变量，绑定过程现阶段是同步执行，后期可直接改成异步执行实现远程配置注入流程。
|`$op` | `Object ( key = Function )` | 此属性主要用于在状态中存储行为绑定函数，以防止每次在 `render` 中去执行**操作降维**（二阶转一阶）。
|`$data` | | 局部可变数据部分，当组件在交互过程形成一个环状，并且依赖当前组件的**自我管理**模式，那么状态中的 `$data` 优先级会高于属性中的 `$data` 优先级。
|「**L**」`$lazy` | `Object` | 延迟加载字段集，列表中用于提高延迟加载的性能，可预处理所有延迟加载数据的部分。
|「**L**」`$columns`| `Array ( Object )` | 列表中的**全列**变量，包含了每一列的基础配置信息。
|「**L**」`$columnsMy`| `Array ( String )` | 根据我的列计算出来的列名数组。
|「**L**」`$table` | `Object` | `<Table/>` 组件专用配置。
|「**L**」`$terms` | `Object` | 列渲染过程中，若某些列包含了 **过滤** 功能，则此属性用于配置列对应的过滤效果。
|「**L**」`$myView`| `Object` | 列表中的视图信息，存储了当前的个人视图相关信息。
|「**L**」`$qr`| `Object` |（略，来自属性）
|「**L**」`$qrVLock`| `Array` | 列表中用来锁定不可变更的查询条件，由于列表本身支持自定义功能，但自定义会受到**锁定字段**的限制。
|「**L**」`$query`| `Object` |（略，来自属性）
|「**L**」`$queryDefault`| `Object` |此数据结构和 `$query` 一致，但不会轻易变化，只会受到属性中 `$query` 变量的影响，它不可以被列表内部变更。
|「**L**」`$queryView`| `Object` |**此属性才是实际执行过程中使用的查询条件**，真实查询条件计算公式：`$queryDefault + <改变> = $queryView`，且此变量中会带上视图配置的基本数据。
|====

说明：

1. 三个状态变量：`$loading, $submitting, $spinning`：简单组件中系统不必依赖三个变量来完成单向数据流的闭环，三个变量的模式一般是在复杂的单向流中会使用，比如数据流出现交汇和分叉。
2. `$myView` 变量比较特殊，代表当前个人视图，在列表级直接存储在 State 状态中，证明是可以更改的；而这个变量在表单级是直接继承传递给属性（ `props` ）的，是不可以更改的，一定要注意表格中的位置和标记。
3. 上述属性中大部分属性都是针对 `ExForm / ExListXxx` 类型的组件，用于扩展快速开发：**列表 + 表单** 的专用全模块页面。
4. 表格中不包含常用的函数 `Function` 类型，如 `Ux.fn(reference) / Ux.of(reference)` 两个对象在快速开发章节详细讲解。

====
上述表格会一直更新，包括后续组件讲解随时可以使用，尽可能在全框架中保证概念统一。
====





